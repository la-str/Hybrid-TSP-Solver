# Hybrid classical-quantum solver for a Travelling Salesman Problem (TSP)

The code in this repository contains a hybrid classical-quantum approach to solve a large Travelling Salesman Problem (TSP). 

A large problem instance is broken down into a smaller problem instance by spliting the cities into clusters. This smaller problem instance, described by the cluster centres, is then solved using the Quantum Approximate Optimization Algorithm (QAOA). The solution to this smaller problem instance is then expanded to create an initial seed permuation for the original TSP instance. Using a classical heuristic solver and this seed, a solution to the large TSP instance is computed.


## Installation

Install the required files with the following command:

`py -m pip install -r requirements.txt`


## Input file specification

The input files need to be .csv files. The first row is a header row which will be ignored when the file is read in. It needs two columns separated by a comma, the first one containing the latitude and the second one the longitude information. An example can be found in `example-latlon.csv` in the `latlonlists` directory.


## Main scripts

### geosolve_check-feasibility.py

This script reads in a (large) TSP instance from a given file. The large TSP instance is split into clusters to create a new TSP instance with the cluster centres as the new cities. The script applies the QAOA to this TSP instance. After running the QAOA, it checks whether the resulting solution is feasible, i.e., whether it meets the criteria of visiting each city once (and only once) and returning to the origin city. If the solution is feasible, the script then expands the solution to an initial seed permutation for the large original TSP instance. This large TSP instance is then solved using a classical heuristic solver. The solver is called twice, once with a random starting permutation and once with the intital seed permutation. Some log data collected throughout the script and the results of the solver runs are written to a log file.

### geosolve_check-feasibility_run-all.py

This script follows the same steps as `geosolve_check-feasibility.py`, but it automatically runs through all TSP instances saved in a given directory. It also runs each example for different number of clusters (currently set to 3, 4, and 5). The results of the solver runs and collected log data are written to a log file.

### geosolve_classical_large-tsp_run-all.py

This script's purpose is to collect data for a statistical analysis. For each of the large TSP instances saved in a given directory, it repeatedly runs through a classical heuristic solver for a given number of iterations. The solver is applied to the large TSP with a random starting permutation as well as with the intial seed permutations that were obtained from the runs using clustering (with 3, 4, and 5 clusters). The results of the solver runs and collected log data are written to a log file.


## Usage

### Running the solver for multiple TSP instances
  1. Run `geosolve-check-feasibility_run-all.py`.
  2. Run `process_logs.py` - to extract the optimisation steps (times and cost values) of the classical solver from the logs and save them to an Excel file.
  3. Run `plot_results.py` - to generate plots of the results.

  Additional optional steps for collecting data for a statistical analysis:

  4. Run `extract_seed_permutations.py` - to extract the QAOA optimised and expanded permutations from the logs.
  5. Run `geosolve_classical_large-tsp_run-all.py` - to run the solver multiple times with and without the QAOA optimised and expanded permutations found in step 4.
  6. Run `process_logs_classical_large_run.py` - to extract the optimisation steps (times and cost values) of the classical solver from the logs and save them to an Excel file.

### Note
For all runs except those generated by `geosolve_classical_large-tsp_run-all.py`, the run data is extracted with the `process_logs.py` script. Otherwise run `process_logs_classical_large_run.py`.